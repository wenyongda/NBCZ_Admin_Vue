<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.nlog-project.org/schemas/NLog.xsd NLog.xsd"
      autoReload="true"
      internalLogLevel="Info"
      internalLogFile="nlog-internal.log"
      throwConfigExceptions="true">
    <targets async="true">
        <target name="console" xsi:type="ColoredConsole"
                layout="${date:format=yyyy-MM-dd HH\:mm\:ss} | ${level:uppercase=true}  ${newline} ${message}">
            <highlight-row condition="level == LogLevel.Debug" foregroundColor="DarkGray" />
            <highlight-row condition="level == LogLevel.Info" foregroundColor="Green" />
            <highlight-row condition="level == LogLevel.Warn" foregroundColor="Yellow" />
            <highlight-row condition="level == LogLevel.Error" foregroundColor="Red" />
            <highlight-row condition="level == LogLevel.Fatal" foregroundColor="Red" backgroundColor="White" />
        </target>

        <target name="allfile" xsi:type="File"
                fileName="${basedir}/logs/all.txt"
                archiveFileName="${basedir}/logs/bak/all/all.{###}.txt"
                archiveEvery="Day"
                archiveNumbering="DateAndSequence"
                archiveAboveSize="20000000"
                maxArchiveFiles="30"
                keepFileOpen="true"
                layout="${date:format=yyyy-MM-dd HH\:mm\:ss} | ${level:uppercase=true}  ${newline} ${message}"/>

        <!--SQL文件-->
        <target name="sqlfile" xsi:type="File"
                fileName="${basedir}/adminlogs/sql.txt"
                archiveFileName="${basedir}/adminlogs/bak/sql/sql.{###}.txt"
                archiveEvery="Day"
                archiveNumbering="DateAndSequence"
                archiveAboveSize="20000000"
                maxArchiveFiles="30"
                keepFileOpen="false"
                layout="${longdate} | ${uppercase:${level}} | ${newline}${message}"/>

        <!--写入彩色控制台-->
        <target name="consoleSql" xsi:type="ColoredConsole" useDefaultRowHighlightingRules="false"
                layout="${date:format=MM-dd HH\:mm\:ss} | ${newline}${message}">
            <highlight-row condition="level == LogLevel.Debug" foregroundColor="DarkGray" />
            <highlight-row condition="level == LogLevel.Info" foregroundColor="Gray" />
            <highlight-row condition="level == LogLevel.Warn" foregroundColor="Yellow" />
            <highlight-row condition="level == LogLevel.Error" foregroundColor="Red" />
            <highlight-row condition="level == LogLevel.Fatal" foregroundColor="Red" backgroundColor="White" />
            <highlight-word regex="SQL" foregroundColor="Blue" />
            <highlight-word regex="【" foregroundColor="Blue" />
            <highlight-word regex="】" foregroundColor="Blue" />
        </target>

        <target name="RequestLog" xsi:type="ColoredConsole"
                layout="${date:format=yyyy-MM-dd HH\:mm\:ss} | ${level:uppercase=true}  ${newline} ${message}">
            <highlight-row condition="level == LogLevel.Debug" foregroundColor="DarkGray" />
            <highlight-row condition="level == LogLevel.Info" foregroundColor="Green" />
            <highlight-row condition="level == LogLevel.Warn" foregroundColor="Yellow" />
            <highlight-row condition="level == LogLevel.Error" foregroundColor="Red" />
            <highlight-row condition="level == LogLevel.Fatal" foregroundColor="Red" backgroundColor="White" />
        </target>
    </targets>
    <rules>
        <logger name="NBCZ.DBUtility.DbHelper.SqlSugarHelper" final="true" writeTo="consoleSql,sqlfile"/>
        <logger name="*" minLevel="Trace" writeTo="console, allfile" />
        <logger name="RequestLog" minLevel="Trace" writeTo="RequestLog" />
    </rules>
</nlog>